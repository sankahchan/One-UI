import{r as n,j as e,f as le,o as oe,b as X}from"./index-DrL1zW_A.js";import{u as Q}from"./useQuery-KR27nzFv.js";import{C as $,u as ue}from"./useToast-BeE1NVOC.js";import{B as w}from"./Button-DfueQd-M.js";import{I as q}from"./Input-DRY4L2lB.js";import{C as he,c as ye}from"./clipboard-DmYgx5sl.js";import{R as de,u as be}from"./useTranslation-BKUwUwH0.js";import{S as fe}from"./save-D208lsBB.js";import"./cn-BLSKlp9E.js";const je=()=>{var z;const c=le(s=>s.token),[R,x]=n.useState(1),[h,g]=n.useState(30),[k,C]=n.useState(""),[i,f]=n.useState(""),[m,j]=n.useState(!0),[O,t]=n.useState("idle"),[p,l]=n.useState(""),[D,S]=n.useState(null),A=Q({queryKey:["system-audit-logs",R,h,k,i],queryFn:async()=>{const s=new URLSearchParams({page:String(R),limit:String(h)});return k.trim()&&s.set("search",k.trim()),i&&s.set("level",i),(await X.get(`/logs/system?${s.toString()}`)).data},enabled:!m});n.useEffect(()=>{!A.data||m||S({logs:A.data.logs||[],generatedAt:new Date().toISOString()})},[m,A.data]),n.useEffect(()=>{if(!m){t("idle"),l("");return}if(!c){t("error"),l("Missing authentication token");return}const s=5,y=new AbortController,_=new TextDecoder;let v="",a=!0,I=0,W=null;const K=()=>{if(I+=1,!a||y.signal.aborted||I>s){t("error"),l(I>s?"Stream unavailable after multiple retries.":"Stream disconnected.");return}const u=Math.min(1e3*2**Math.max(0,I-1),15e3);t("connecting"),l(`Stream disconnected. Retrying in ${(u/1e3).toFixed(0)}s...`),W=window.setTimeout(()=>{L()},u)},L=async()=>{t("connecting"),l("");try{const u=new URLSearchParams({limit:String(h),interval:"2000"});k.trim()&&u.set("search",k.trim()),i&&u.set("level",i);const M=await fetch(`${oe}/logs/system/stream?${u.toString()}`,{method:"GET",headers:{Authorization:`Bearer ${c}`,Accept:"text/event-stream"},signal:y.signal,cache:"no-store"});if(!M.ok||!M.body)throw new Error(`Audit stream unavailable (${M.status})`);if(!a)return;t("connected");const E=M.body.getReader();for(;a;){const{done:Y,value:Z}=await E.read();if(Y){!y.signal.aborted&&a&&K();return}v+=_.decode(Z,{stream:!0});const B=v.split(`

`);v=B.pop()||"";for(const J of B){const r=J.split(`
`);let d="message";const G=[];for(const o of r)o.startsWith("event:")?d=o.slice(6).trim():o.startsWith("data:")&&G.push(o.slice(5).trim());if(G.length===0)continue;const P=G.join(`
`);if(d==="snapshot")try{const o=JSON.parse(P);a&&S({logs:o.logs||[],generatedAt:o.generatedAt})}catch{}else if(d==="error")try{const o=JSON.parse(P);a&&(t("error"),l(o.message||"Audit stream error"))}catch{a&&(t("error"),l(P||"Audit stream error"))}}}}catch(u){!y.signal.aborted&&a&&(l((u==null?void 0:u.message)||"Failed to connect to audit stream"),K())}};return L(),()=>{a=!1,W&&window.clearTimeout(W),y.abort()}},[i,h,m,k,c]);const N=(D==null?void 0:D.logs)||[],F=(z=A.data)==null?void 0:z.pagination,U={INFO:"bg-blue-100 text-blue-700 dark:bg-blue-900/35 dark:text-blue-300",WARNING:"bg-amber-100 text-amber-700 dark:bg-amber-900/35 dark:text-amber-300",ERROR:"bg-red-100 text-red-700 dark:bg-red-900/35 dark:text-red-300",CRITICAL:"bg-purple-100 text-purple-700 dark:bg-purple-900/35 dark:text-purple-300"};return e.jsx($,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Audit Trail"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:"Review system actions, policy applies, and critical operational events."})]}),e.jsx("span",{className:`inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ${O==="connected"?"bg-green-100 text-green-700 dark:bg-green-900/35 dark:text-green-300":O==="connecting"?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/35 dark:text-yellow-300":O==="error"?"bg-red-100 text-red-700 dark:bg-red-900/35 dark:text-red-300":"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-300"}`,children:m?`live:${O}`:"snapshot mode"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2 lg:grid-cols-5",children:[e.jsx(q,{placeholder:"Search message...",value:k,onChange:s=>{x(1),C(s.target.value)},className:"lg:col-span-2"}),e.jsxs("select",{value:i,onChange:s=>{x(1),f(s.target.value)},className:"rounded-lg border border-gray-300 px-3 py-2 text-sm dark:border-gray-600 dark:bg-gray-800 dark:text-white",children:[e.jsx("option",{value:"",children:"All Levels"}),e.jsx("option",{value:"INFO",children:"INFO"}),e.jsx("option",{value:"WARNING",children:"WARNING"}),e.jsx("option",{value:"ERROR",children:"ERROR"}),e.jsx("option",{value:"CRITICAL",children:"CRITICAL"})]}),e.jsxs("select",{value:h,onChange:s=>g(Number.parseInt(s.target.value,10)),className:"rounded-lg border border-gray-300 px-3 py-2 text-sm dark:border-gray-600 dark:bg-gray-800 dark:text-white",children:[e.jsx("option",{value:20,children:"20 rows"}),e.jsx("option",{value:30,children:"30 rows"}),e.jsx("option",{value:50,children:"50 rows"}),e.jsx("option",{value:100,children:"100 rows"})]}),e.jsx(w,{variant:m?"secondary":"primary",onClick:()=>j(s=>!s),children:m?"Pause Live":"Resume Live"})]}),p?e.jsx("div",{className:"rounded-lg border border-red-300 bg-red-50 px-3 py-2 text-sm text-red-700 dark:border-red-900/50 dark:bg-red-900/25 dark:text-red-300",children:p}):null,A.isLoading&&!m?e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Loading audit logs..."}):N.length===0?e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No audit logs found."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-300",children:"Time"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-300",children:"Level"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-300",children:"Message"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-300",children:"Metadata"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white dark:divide-gray-700 dark:bg-gray-900",children:N.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[e.jsx("td",{className:"whitespace-nowrap px-4 py-3 text-xs text-gray-600 dark:text-gray-400",children:new Date(s.timestamp).toLocaleString()}),e.jsx("td",{className:"whitespace-nowrap px-4 py-3 text-xs",children:e.jsx("span",{className:`inline-flex rounded-full px-2 py-0.5 font-semibold ${U[s.level]||"bg-gray-100 text-gray-700"}`,children:s.level})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 dark:text-white",children:s.message}),e.jsx("td",{className:"px-4 py-3 text-xs text-gray-600 dark:text-gray-300",children:e.jsx("pre",{className:"max-h-24 overflow-auto whitespace-pre-wrap rounded-md bg-gray-50 p-2 dark:bg-gray-800/70",children:s.metadata?JSON.stringify(s.metadata,null,2):"-"})})]},s.id))})]})}),!m&&F?e.jsxs("div",{className:"flex items-center justify-between pt-2",children:[e.jsx(w,{variant:"secondary",size:"sm",disabled:R<=1,onClick:()=>x(s=>s-1),children:"Previous"}),e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Page ",F.page," of ",F.totalPages]}),e.jsx(w,{variant:"secondary",size:"sm",disabled:R>=F.totalPages,onClick:()=>x(s=>s+1),children:"Next"})]}):null]})})},ve=()=>{var J;const c=le(r=>r.token),R=ue(),{t:x}=be(),h=n.useRef(null),[g,k]=n.useState("access"),[C,i]=n.useState(200),[f,m]=n.useState(""),[j,O]=n.useState(""),[t,p]=n.useState(""),[l,D]=n.useState(""),[S,A]=n.useState(""),[N,F]=n.useState(!0),[U,z]=n.useState(!0),[s,y]=n.useState("idle"),[_,v]=n.useState(""),[a,I]=n.useState(null),[W,K]=n.useState(!1),L=Q({queryKey:["xray-log-tail",g,C,f,j,t,l,S],queryFn:async()=>{const r=new URLSearchParams({type:g,lines:String(C)});return f.trim()&&r.set("search",f.trim()),j&&r.set("level",j),t&&r.set("protocol",t),l.trim()&&r.set("ip",l.trim()),S.trim()&&r.set("user",S.trim()),(await X.get(`/logs/xray/tail?${r.toString()}`)).data},enabled:!N,refetchInterval:N?!1:5e3});n.useEffect(()=>{L.data&&I(L.data)},[L.data]),n.useEffect(()=>{if(!N){y("idle"),v("");return}if(!c){y("error"),v("Missing authentication token");return}const r=5,d=new AbortController,G=new TextDecoder;let P="",o=!0,V=0,ee=null;const se=()=>{if(V+=1,!o||d.signal.aborted||V>r){y("error"),v(V>r?"Stream unavailable after multiple retries.":"Stream disconnected.");return}const b=Math.min(1e3*2**Math.max(0,V-1),15e3);y("connecting"),v(`Stream disconnected. Retrying in ${(b/1e3).toFixed(0)}s...`),ee=window.setTimeout(()=>{ne()},b)},ne=async()=>{y("connecting"),v("");try{const b=new URLSearchParams({type:g,lines:String(C),interval:"2000"});f.trim()&&b.set("search",f.trim()),j&&b.set("level",j),t&&b.set("protocol",t),l.trim()&&b.set("ip",l.trim()),S.trim()&&b.set("user",S.trim());const H=await fetch(`${oe}/logs/xray/stream?${b.toString()}`,{method:"GET",headers:{Authorization:`Bearer ${c}`,Accept:"text/event-stream"},signal:d.signal,cache:"no-store"});if(!H.ok||!H.body)throw new Error(`Stream unavailable (${H.status})`);if(!o)return;y("connected");const ce=H.body.getReader();for(;o;){const{done:xe,value:ge}=await ce.read();if(xe){!d.signal.aborted&&o&&se();return}P+=G.decode(ge,{stream:!0});const ie=P.split(`

`);P=ie.pop()||"";for(const me of ie){const pe=me.split(`
`);let te="message";const re=[];for(const T of pe)T.startsWith("event:")?te=T.slice(6).trim():T.startsWith("data:")&&re.push(T.slice(5).trim());if(re.length===0)continue;const ae=re.join(`
`);if(te==="snapshot")try{const T=JSON.parse(ae);o&&I(T)}catch{}else if(te==="error")try{const T=JSON.parse(ae);o&&v(T.message||"Stream error")}catch{o&&v(ae||"Stream error")}}}}catch(b){!d.signal.aborted&&o&&(v((b==null?void 0:b.message)||"Failed to connect to Xray logs stream"),se())}};return ne(),()=>{o=!1,ee&&window.clearTimeout(ee),d.abort()}},[N,c,g,C,f,j,t,l,S]),n.useEffect(()=>{!U||!h.current||(h.current.scrollTop=h.current.scrollHeight)},[a==null?void 0:a.timestamp,U]);const u=n.useMemo(()=>(a==null?void 0:a.lines)??[],[a==null?void 0:a.lines]),M=n.useMemo(()=>(a==null?void 0:a.entries)??[],[a==null?void 0:a.entries]),E=a==null?void 0:a.summary,Y=async()=>{N||await L.refetch()},Z=async()=>{try{if(!await ye(u.join(`
`)))throw new Error("copy_failed");K(!0),window.setTimeout(()=>K(!1),1200)}catch{R.error(x("common.error",{defaultValue:"Error"}),x("logs.toast.copyFailed",{defaultValue:"Failed to copy logs"}))}},B=()=>{const r=new Blob([u.join(`
`)],{type:"text/plain;charset=utf-8"}),d=document.createElement("a");d.href=URL.createObjectURL(r),d.download=`xray-${g}-logs-${new Date().toISOString()}.log`,d.click(),URL.revokeObjectURL(d.href)};return e.jsx($,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Xray Live Logs"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:"Inspect access, error, and output logs in real time."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ${s==="connected"?"bg-green-100 text-green-700 dark:bg-green-900/35 dark:text-green-300":s==="connecting"?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/35 dark:text-yellow-300":s==="error"?"bg-red-100 text-red-700 dark:bg-red-900/35 dark:text-red-300":"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-300"}`,children:s}),a!=null&&a.missing?e.jsx("span",{className:"inline-flex items-center rounded-full bg-red-100 px-2.5 py-1 text-xs font-semibold text-red-700 dark:bg-red-900/35 dark:text-red-300",children:"File missing"}):null]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2 xl:grid-cols-4",children:[e.jsxs("select",{value:g,onChange:r=>k(r.target.value),className:"rounded-lg border border-gray-300 px-3 py-2 text-sm dark:border-gray-600 dark:bg-gray-800 dark:text-white",children:[e.jsx("option",{value:"access",children:"access.log"}),e.jsx("option",{value:"error",children:"error.log"}),e.jsx("option",{value:"output",children:"output.log"})]}),e.jsxs("select",{value:C,onChange:r=>i(Number.parseInt(r.target.value,10)),className:"rounded-lg border border-gray-300 px-3 py-2 text-sm dark:border-gray-600 dark:bg-gray-800 dark:text-white",children:[e.jsx("option",{value:100,children:"Last 100 lines"}),e.jsx("option",{value:200,children:"Last 200 lines"}),e.jsx("option",{value:500,children:"Last 500 lines"}),e.jsx("option",{value:1e3,children:"Last 1000 lines"})]}),e.jsx(q,{placeholder:"Search logs...",value:f,onChange:r=>m(r.target.value),className:"xl:col-span-2"}),e.jsxs("select",{value:j,onChange:r=>O(r.target.value),className:"rounded-lg border border-gray-300 px-3 py-2 text-sm dark:border-gray-600 dark:bg-gray-800 dark:text-white",children:[e.jsx("option",{value:"",children:"All Levels"}),e.jsx("option",{value:"DEBUG",children:"DEBUG"}),e.jsx("option",{value:"INFO",children:"INFO"}),e.jsx("option",{value:"WARNING",children:"WARNING"}),e.jsx("option",{value:"ERROR",children:"ERROR"}),e.jsx("option",{value:"UNKNOWN",children:"UNKNOWN"})]}),e.jsxs("select",{value:t,onChange:r=>p(r.target.value),className:"rounded-lg border border-gray-300 px-3 py-2 text-sm dark:border-gray-600 dark:bg-gray-800 dark:text-white",children:[e.jsx("option",{value:"",children:"All Protocols"}),e.jsx("option",{value:"VLESS",children:"VLESS"}),e.jsx("option",{value:"VMESS",children:"VMESS"}),e.jsx("option",{value:"TROJAN",children:"TROJAN"}),e.jsx("option",{value:"SHADOWSOCKS",children:"SHADOWSOCKS"}),e.jsx("option",{value:"SOCKS",children:"SOCKS"}),e.jsx("option",{value:"HTTP",children:"HTTP"}),e.jsx("option",{value:"DOKODEMO_DOOR",children:"DOKODEMO_DOOR"}),e.jsx("option",{value:"WIREGUARD",children:"WIREGUARD"}),e.jsx("option",{value:"MTPROTO",children:"MTPROTO"}),e.jsx("option",{value:"UNKNOWN",children:"UNKNOWN"})]}),e.jsx(q,{placeholder:"Filter IP...",value:l,onChange:r=>D(r.target.value)}),e.jsx(q,{placeholder:"Filter user/email/uuid...",value:S,onChange:r=>A(r.target.value)}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(w,{variant:N?"secondary":"primary",className:"flex-1",onClick:()=>F(r=>!r),children:N?"Pause":"Resume"})})]}),E?e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2 xl:grid-cols-4",children:[e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-gray-50 px-3 py-2 dark:border-gray-700 dark:bg-gray-900",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400",children:"Matched Lines"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:E.total})]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-gray-50 px-3 py-2 dark:border-gray-700 dark:bg-gray-900",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400",children:"ERROR"}),e.jsx("p",{className:"text-sm font-semibold text-red-600 dark:text-red-400",children:E.levels.ERROR||0})]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-gray-50 px-3 py-2 dark:border-gray-700 dark:bg-gray-900",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400",children:"WARNING"}),e.jsx("p",{className:"text-sm font-semibold text-amber-600 dark:text-amber-400",children:E.levels.WARNING||0})]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-gray-50 px-3 py-2 dark:border-gray-700 dark:bg-gray-900",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400",children:"TOP PROTOCOL"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:((J=Object.entries(E.protocols).sort((r,d)=>(d[1]||0)-(r[1]||0))[0])==null?void 0:J[0])||"N/A"})]})]}):null,e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(w,{variant:"secondary",size:"sm",onClick:()=>{Y()},disabled:N,loading:L.isFetching,children:[e.jsx(de,{className:"mr-2 h-4 w-4"}),"Refresh"]}),e.jsx(w,{variant:"secondary",size:"sm",onClick:()=>z(r=>!r),children:U?"Auto-scroll: ON":"Auto-scroll: OFF"}),e.jsxs(w,{variant:"secondary",size:"sm",onClick:()=>{Z()},children:[e.jsx(he,{className:"mr-2 h-4 w-4"}),W?"Copied":"Copy"]}),e.jsxs(w,{variant:"secondary",size:"sm",onClick:B,children:[e.jsx(fe,{className:"mr-2 h-4 w-4"}),"Download"]}),e.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:["Entries: ",M.length]}),a!=null&&a.path?e.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:["Path: ",a.path]}):null]}),_?e.jsx("div",{className:"rounded-lg border border-red-300 bg-red-50 px-3 py-2 text-sm text-red-700 dark:border-red-900/50 dark:bg-red-900/25 dark:text-red-300",children:_}):null,e.jsx("pre",{ref:h,className:"max-h-[420px] overflow-auto rounded-lg border border-gray-200 bg-gray-50 p-4 text-xs leading-5 text-gray-800 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-200",children:u.length>0?u.join(`
`):"No log lines available."})]})})},Ae=()=>{var f,m,j,O;const[c,R]=n.useState(1),[x,h]=n.useState({clientIp:"",action:""}),{data:g,isLoading:k,refetch:C}=Q({queryKey:["connection-logs",c,x],queryFn:async()=>{var l;const t=new URLSearchParams({page:String(c),limit:"20"});return x.clientIp&&t.set("clientIp",x.clientIp),x.action&&t.set("action",x.action),(l=(await X.get(`/logs/connections?${t.toString()}`)).data)==null?void 0:l.data},refetchInterval:1e4}),{data:i}=Q({queryKey:["connection-logs-stats"],queryFn:async()=>{var p;return(p=(await X.get("/logs/connections/stats")).data)==null?void 0:p.data}});return e.jsxs("div",{className:"space-y-6",children:[e.jsx(je,{}),e.jsx(ve,{}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsxs($,{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Logs"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:((f=i==null?void 0:i.total)==null?void 0:f.toLocaleString())||0})]}),e.jsxs($,{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Today"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:((m=i==null?void 0:i.today)==null?void 0:m.toLocaleString())||0})]}),e.jsxs($,{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"This Week"}),e.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:((j=i==null?void 0:i.thisWeek)==null?void 0:j.toLocaleString())||0})]})]}),e.jsxs($,{children:[e.jsxs("div",{className:"mb-4 flex flex-wrap items-center justify-between gap-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Connection Logs"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(q,{placeholder:"Filter by IP...",value:x.clientIp,onChange:t=>h(p=>({...p,clientIp:t.target.value})),className:"w-40"}),e.jsxs("select",{value:x.action,onChange:t=>h(p=>({...p,action:t.target.value})),className:"rounded-lg border border-gray-300 px-3 py-2 text-sm dark:border-gray-600 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"",children:"All Actions"}),e.jsx("option",{value:"connect",children:"Connect"}),e.jsx("option",{value:"disconnect",children:"Disconnect"})]}),e.jsx(w,{variant:"secondary",onClick:()=>C(),children:e.jsx(de,{className:"h-4 w-4"})})]})]}),k?e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Loading..."}):(O=g==null?void 0:g.logs)!=null&&O.length?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-300",children:"Time"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-300",children:"User"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-300",children:"Inbound"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-300",children:"IP"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-300",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white dark:divide-gray-700 dark:bg-gray-900",children:g.logs.map(t=>{var p;return e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-500 dark:text-gray-400",children:new Date(t.timestamp).toLocaleString()}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm font-medium text-gray-900 dark:text-white",children:((p=t.user)==null?void 0:p.email)||`User #${t.userId}`}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-500 dark:text-gray-400",children:t.inbound?`${t.inbound.tag} (${t.inbound.protocol})`:`Inbound #${t.inboundId}`}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-500 dark:text-gray-400",children:t.clientIp}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm",children:e.jsx("span",{className:`inline-flex rounded-full px-2 text-xs font-semibold leading-5 ${t.action==="connect"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300"}`,children:t.action})})]},t.id)})})]})}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsx(w,{variant:"secondary",disabled:c===1,onClick:()=>R(c-1),children:"Previous"}),e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Page ",c," of ",g.pages]}),e.jsx(w,{variant:"secondary",disabled:c===g.pages,onClick:()=>R(c+1),children:"Next"})]})]}):e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No connection logs yet."})]})]})};export{Ae as default};
