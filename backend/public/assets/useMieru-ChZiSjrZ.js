import{u as n}from"./useQuery-ClalJbNF.js";import{b as s,e as i}from"./index-CG9kpP9Y.js";import{u as a}from"./useMutation-Br-t0osD.js";const t={getPolicy:async()=>s.get("/mieru/policy"),getStatus:async()=>s.get("/mieru/status"),restart:async()=>s.post("/mieru/restart"),syncUsers:async e=>s.post("/mieru/sync",e?{reason:e}:{}),getLogs:async(e={})=>s.get("/mieru/logs",{params:e}),getProfile:async()=>s.get("/mieru/profile"),updateProfile:async e=>s.put("/mieru/profile",e),listUsers:async(e={})=>s.get("/mieru/users",{params:e}),createUser:async e=>s.post("/mieru/users",e),updateUser:async(e,r)=>s.put(`/mieru/users/${encodeURIComponent(e)}`,r),deleteUser:async e=>s.delete(`/mieru/users/${encodeURIComponent(e)}`),getOnlineSnapshot:async()=>s.get("/mieru/online"),getUserExport:async e=>s.get(`/mieru/users/${encodeURIComponent(e)}/export`)},o=async()=>(await t.getPolicy()).data??{enabled:!1,mode:"docker",containerName:"mieru-sidecar",composeServiceName:"mieru",composeFilePath:"/opt/one-ui/docker-compose.yml",healthUrl:null,manualRestartCommandConfigured:!1,manualLogPathConfigured:!1},c=async()=>{const e=await t.getStatus();if(!e.data)throw new Error(e.message||"Unable to fetch Mieru status");return e.data},y=async()=>{const e=await t.restart();if(!e.data)throw new Error(e.message||"Unable to restart Mieru sidecar");return e.data},l=async e=>{const r=await t.syncUsers(e);if(!r.data)throw new Error(r.message||"Unable to sync Mieru users");return r.data},d=async(e=120)=>{const r=await t.getLogs({lines:e});if(!r.data)throw new Error(r.message||"Unable to fetch Mieru logs");return r.data},m=async()=>{const e=await t.getProfile();if(!e.data)throw new Error(e.message||"Unable to fetch Mieru profile");return e.data},p=async e=>{const r=await t.updateProfile(e);if(!r.data)throw new Error(r.message||"Unable to update Mieru profile");return r.data},g=async(e=!0)=>{const r=await t.listUsers({includeOnline:e});if(!r.data)throw new Error(r.message||"Unable to fetch Mieru users");return r.data},f=async e=>{const r=await t.createUser(e);if(!r.data)throw new Error(r.message||"Unable to create Mieru user");return r.data},U=async(e,r)=>{const u=await t.updateUser(e,r);if(!u.data)throw new Error(u.message||"Unable to update Mieru user");return u.data},v=async e=>{const r=await t.deleteUser(e);if(!r.data)throw new Error(r.message||"Unable to delete Mieru user");return r.data},M=async e=>{const r=await t.getUserExport(e);if(!r.data)throw new Error(r.message||"Unable to generate Mieru export");return r.data},K=()=>n({queryKey:["mieru-policy"],queryFn:o,refetchInterval:3e4,staleTime:1e4}),Q=()=>n({queryKey:["mieru-status"],queryFn:c,refetchInterval:15e3,staleTime:5e3}),C=(e=120,r=!0)=>n({queryKey:["mieru-logs",e],queryFn:()=>d(e),enabled:r,staleTime:3e3}),E=()=>{const e=i();return a({mutationFn:y,onSuccess:()=>{e.invalidateQueries({queryKey:["mieru-status"]}),e.invalidateQueries({queryKey:["mieru-logs"]}),e.invalidateQueries({queryKey:["mieru-policy"]})}})},b=()=>{const e=i();return a({mutationFn:r=>l(r),onSuccess:()=>{e.invalidateQueries({queryKey:["mieru-status"]}),e.invalidateQueries({queryKey:["mieru-logs"]}),e.invalidateQueries({queryKey:["mieru-policy"]})}})},P=()=>n({queryKey:["mieru-profile"],queryFn:m,staleTime:1e4}),F=(e=!0)=>n({queryKey:["mieru-users",e],queryFn:()=>g(e),refetchInterval:e?15e3:!1,staleTime:5e3}),S=()=>{const e=i();return a({mutationFn:p,onSuccess:()=>{e.invalidateQueries({queryKey:["mieru-profile"]}),e.invalidateQueries({queryKey:["mieru-users"]}),e.invalidateQueries({queryKey:["mieru-online"]})}})},x=()=>{const e=i();return a({mutationFn:f,onSuccess:()=>{e.invalidateQueries({queryKey:["mieru-users"]}),e.invalidateQueries({queryKey:["mieru-online"]}),e.invalidateQueries({queryKey:["mieru-status"]})}})},I=()=>{const e=i();return a({mutationFn:({username:r,payload:u})=>U(r,u),onSuccess:()=>{e.invalidateQueries({queryKey:["mieru-users"]}),e.invalidateQueries({queryKey:["mieru-online"]}),e.invalidateQueries({queryKey:["mieru-status"]})}})},L=()=>{const e=i();return a({mutationFn:v,onSuccess:()=>{e.invalidateQueries({queryKey:["mieru-users"]}),e.invalidateQueries({queryKey:["mieru-online"]}),e.invalidateQueries({queryKey:["mieru-status"]})}})},R=()=>a({mutationFn:M});export{Q as a,P as b,F as c,b as d,E as e,S as f,x as g,I as h,L as i,R as j,C as k,K as u};
