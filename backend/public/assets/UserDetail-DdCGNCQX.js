const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/TrafficChart-B79objTb.js","assets/index-CG9kpP9Y.js","assets/index-CujEh0NH.css","assets/useQuery-ClalJbNF.js","assets/formatters-CEEtD2TU.js","assets/useToast-C_OO-2JX.js","assets/cn-BLSKlp9E.js","assets/UserActivityTimeline-DaQLQT0x.js","assets/Button-B80QVKRC.js","assets/Input-vpwyIRrG.js","assets/useUsers-BPTWPe_a.js","assets/useMutation-Br-t0osD.js","assets/users-DYrgyhkk.js","assets/useTranslation-DQjABgHn.js","assets/wifi-BjumB3Vv.js","assets/activity-DlclupDX.js","assets/SubscriptionLinksPanel-oLiQv5Po.js","assets/index-BaaKCiO9.js","assets/subscriptionApps-BkFFy6rX.js","assets/clipboard-D_hUxpVN.js","assets/deepLink-V1nSjne_.js","assets/MyanmarPriorityPreviewModal-gwumv2Y2.js","assets/index.esm-C0GmNgaO.js","assets/useGroups-B1L4fEZz.js","assets/inbounds-BVe_b115.js","assets/external-link-CxefftMD.js","assets/download-CX5md0Yg.js","assets/qr-code-BvM-7NwP.js","assets/chevron-up-C-Yx4ITY.js","assets/chevron-down-DRrM9xHJ.js"])))=>i.map(i=>d[i]);
import{c as Ee,i as at,u as lt,r as o,j as e,R as H,_ as Le,b as rt}from"./index-CG9kpP9Y.js";import{B as Se}from"./Badge-DQo9BAHa.js";import{B as j}from"./Button-B80QVKRC.js";import{u as nt,C as v}from"./useToast-C_OO-2JX.js";import{D as os,M as cs}from"./DropdownMenu-DeZo-vZf.js";import{C as it}from"./ConfirmDialog-BK4iJYOB.js";import{I as dt,P as ot,a as ct}from"./InboundClientProfileModal-Bk4NkUOW.js";import{C as us,U as ut,M as ms}from"./MyanmarPriorityPreviewModal-gwumv2Y2.js";import{S as Q}from"./Skeleton-UQb2SfAS.js";import{p as mt,q as ft}from"./useGroups-B1L4fEZz.js";import{r as xt,s as pt,t as bt,c as yt,v as ht,w as gt,x as jt,y as vt,p as Nt,n as Vt,q as wt}from"./useUsers-BPTWPe_a.js";import{u as ce}from"./users-DYrgyhkk.js";import{C as Ae,c as kt}from"./clipboard-D_hUxpVN.js";import{f as w,b as _}from"./formatters-CEEtD2TU.js";import{u as It,R as ue}from"./useTranslation-DQjABgHn.js";import{L as Dt}from"./layout-dashboard-BPYhmTPx.js";import{P as Pt}from"./pen-square-DzONsOB7.js";import{S as Te}from"./sparkles-BY22KUTF.js";import{R as St}from"./rotate-ccw-COvDNp33.js";import{T as At}from"./trash-2-BX_Hm8OC.js";import{F as Tt}from"./file-code-2-B1nNAYmF.js";import{A as Mt}from"./arrow-up-C-Gbu-3p.js";import{A as Ct}from"./arrow-down-CRYy1JIM.js";import{E as Et}from"./external-link-CxefftMD.js";import"./cn-BLSKlp9E.js";import"./index-BaaKCiO9.js";import"./useQuery-ClalJbNF.js";import"./Spinner-8vpN8vrI.js";import"./download-CX5md0Yg.js";import"./qr-code-BvM-7NwP.js";import"./index.esm-C0GmNgaO.js";import"./Input-vpwyIRrG.js";import"./inbounds-BVe_b115.js";import"./useMutation-Br-t0osD.js";/**
 * @license lucide-react v0.298.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lt=Ee("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.298.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=Ee("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.298.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kt=Ee("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]),Ut=H.lazy(()=>Le(()=>import("./TrafficChart-B79objTb.js"),__vite__mapDeps([0,1,2,3,4,5,6])).then(y=>({default:y.TrafficChart}))),Rt=H.lazy(()=>Le(()=>import("./UserActivityTimeline-DaQLQT0x.js"),__vite__mapDeps([7,1,2,5,6,8,9,10,3,11,12,4,13,14,15])).then(y=>({default:y.UserActivityTimeline}))),Ft=H.lazy(()=>Le(()=>import("./SubscriptionLinksPanel-oLiQv5Po.js"),__vite__mapDeps([16,1,2,3,17,5,6,18,19,20,8,21,22,23,24,11,12,10,9,13,25,26,27,28,29])).then(y=>({default:y.SubscriptionLinksPanel}))),Me=()=>e.jsx(v,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsx(Q,{className:"h-5 w-40"}),e.jsx(Q,{className:"h-4 w-full"}),e.jsx(Q,{className:"h-4 w-3/4"}),e.jsx(Q,{className:"h-32 w-full"})]})}),$t=[{label:"5s",value:5e3},{label:"10s",value:1e4},{label:"30s",value:3e4},{label:"Manual",value:0}],Ce=(y,K,u,s)=>{if(K)return y("users.sessions.liveNow",{defaultValue:"Live now"});if(!u)return y("users.sessions.noActivity",{defaultValue:"No activity"});const Z=new Date(u).getTime();if(Number.isNaN(Z))return y("users.sessions.noActivity",{defaultValue:"No activity"});const G=Math.max(0,s-Z),M=Math.floor(G/6e4),U=Math.floor(M/60),i=Math.floor(U/24),P=M<1?y("users.sessions.justNow",{defaultValue:"just now"}):M<60?y("users.sessions.minutesAgo",{defaultValue:"{{count}}m ago",count:M}):U<24?y("users.sessions.hoursAgo",{defaultValue:"{{count}}h ago",count:U}):y("users.sessions.daysAgo",{defaultValue:"{{count}}d ago",count:i});return y("users.sessions.lastSeenPrefix",{defaultValue:"Last seen {{label}}",label:P})},Ot=()=>{var Ze,es,ss,ts,as,ls,rs,ns,is,ds;const{id:y}=at(),K=lt(),u=nt(),{t:s}=It(),[Z,G]=o.useState(!1),[M,U]=o.useState(""),[i,P]=o.useState(null),[Ke,Ue]=o.useState(null),[me,Re]=o.useState(null),[xs,Fe]=o.useState(null),[ps,$e]=o.useState(null),[S,Oe]=o.useState(!1),[fe,ee]=o.useState(!1),[xe,se]=o.useState(!1),[R,Be]=o.useState(null),[ze,pe]=o.useState(null),[F,bs]=o.useState(()=>Date.now()),[A,ys]=o.useState(1e4),[C,be]=o.useState("all"),[W,ye]=o.useState("priority"),[he,te]=o.useState("asc"),[E,hs]=o.useState("comfortable"),[p,ge]=o.useState(null),[f,je]=o.useState(null),[$,_e]=o.useState(null),N=Number.parseInt(y||"",10),{data:ve,isLoading:gs,refetch:T}=xt(N),k=pt(N,60,{refetchInterval:A===0?!1:A,staleTime:5e3}),ae=mt(N),le=ft(N),re=bt(),ne=yt(),Ne=ht(),js=gt(),vs=jt(),Ns=vt(),Ve=Nt(),Vs=Vt({refetchInterval:A===0?!1:A,staleTime:5e3}),O=wt(Number.isInteger(N)&&N>0?[N]:[],{includeOffline:!0,live:A!==0,refetchInterval:A===0?!1:A,staleTime:5e3,streamInterval:2e3});o.useEffect(()=>{const t=window.setInterval(()=>{bs(Date.now())},6e4);return()=>{window.clearInterval(t)}},[]),o.useEffect(()=>{_e(null)},[N]);const r=(ve==null?void 0:ve.data)??null,h=o.useMemo(()=>{var t;return(((t=O.data)==null?void 0:t.sessions)||[]).find(l=>l.userId===N)||null},[(Ze=O.data)==null?void 0:Ze.sessions,N]),we=(es=ae.data)==null?void 0:es.data,c=(ss=le.data)==null?void 0:ss.data,V=Number((r==null?void 0:r.dataLimit)||0),ws=Number((r==null?void 0:r.uploadUsed)||0),ks=Number((r==null?void 0:r.downloadUsed)||0),J=Number((r==null?void 0:r.totalUsed)??ws+ks),Qe=Number((r==null?void 0:r.remaining)??Math.max(0,V-J)),Is=Number((r==null?void 0:r.remainingPercent)??(V>0?Qe/V*100:0)),He=V>0?Math.min(J/V*100,100):0,ie=Number((r==null?void 0:r.daysRemaining)??Math.ceil((new Date((r==null?void 0:r.expireDate)||F).getTime()-F)/(1e3*60*60*24))),Ge=!!(r!=null&&r.startOnFirstUse)&&!(r!=null&&r.firstUsedAt),X=!!(h!=null&&h.online),Ds=o.useMemo(()=>Ce(s,X,(h==null?void 0:h.lastSeenAt)??null,F),[X,F,h==null?void 0:h.lastSeenAt,s]),Ps=O.isFetching||O.streamStatus==="connecting",de=o.useMemo(()=>{var t,l;return((l=(t=k.data)==null?void 0:t.data)==null?void 0:l.devices)??[]},[(as=(ts=k.data)==null?void 0:ts.data)==null?void 0:as.devices]),Y=o.useMemo(()=>{var l;const t=new Map;for(const a of de){const d=Number((l=a==null?void 0:a.inbound)==null?void 0:l.id);if(!Number.isInteger(d)||d<=0)continue;const n=t.get(d)||{onlineDevices:0,seenDevices:0,lastSeenAt:null},x=!!(a!=null&&a.online),m=typeof(a==null?void 0:a.lastSeenAt)=="string"?a.lastSeenAt:null,b=m?n.lastSeenAt?new Date(m).getTime()>new Date(n.lastSeenAt).getTime()?m:n.lastSeenAt:m:n.lastSeenAt;t.set(d,{onlineDevices:n.onlineDevices+(x?1:0),seenDevices:n.seenDevices+1,lastSeenAt:b})}return t},[de]),I=E==="compact"?"px-3 py-2.5":"px-4 py-3",D=E==="compact"?"px-3 py-2":"px-4 py-3",Ss=E==="compact"?"p-3":"p-4",As=E==="compact"?"space-y-1.5":"space-y-2",Ts=E==="compact"?"mt-2.5":"mt-3",B=o.useMemo(()=>{const t=(r==null?void 0:r.inbounds)||[],l=X&&t.length===1;return t.map((a,d)=>({relation:a,index:d,label:a.inbound.remark||a.inbound.tag||s("users.detail.keyFallback",{defaultValue:"Key {{count}}",count:d+1}),protocol:a.inbound.protocol,port:Number(a.inbound.port||0),priority:Number.isInteger(Number(a.priority))?Number(a.priority):100+d,enabled:!!a.enabled,online:(()=>{var x;if(!a.enabled)return!1;const n=Number(a.inboundId||((x=a.inbound)==null?void 0:x.id));if(Number.isInteger(n)&&n>0){const m=Y.get(n);if(m&&m.onlineDevices>0)return!0}return l})(),lastSeenAt:(()=>{var x;const n=Number(a.inboundId||((x=a.inbound)==null?void 0:x.id));if(Number.isInteger(n)&&n>0){const m=Y.get(n);if(m!=null&&m.lastSeenAt)return m.lastSeenAt}return l?(h==null?void 0:h.lastSeenAt)??null:null})(),onlineDevices:(()=>{var x,m;const n=Number(a.inboundId||((x=a.inbound)==null?void 0:x.id));return Number.isInteger(n)&&n>0?((m=Y.get(n))==null?void 0:m.onlineDevices)??0:l?1:0})(),seenDevices:(()=>{var x,m;const n=Number(a.inboundId||((x=a.inbound)==null?void 0:x.id));return Number.isInteger(n)&&n>0?((m=Y.get(n))==null?void 0:m.seenDevices)??0:l?1:0})(),expirationDays:ie}))},[ie,Y,X,h==null?void 0:h.lastSeenAt,s,r==null?void 0:r.inbounds]),Ms=o.useMemo(()=>B.filter(t=>t.enabled).length,[B]),Cs=o.useMemo(()=>B.filter(t=>t.online).length,[B]),oe=o.useMemo(()=>{const t=B.filter(a=>C==="enabled"?a.enabled:C==="disabled"?!a.enabled:C==="online"?a.online:C==="offline"?!a.online:!0),l=he==="asc"?1:-1;return t.sort((a,d)=>{let n=0;switch(W){case"key":n=a.label.localeCompare(d.label);break;case"protocol":n=a.protocol.localeCompare(d.protocol);break;case"port":n=a.port-d.port;break;case"priority":n=a.priority-d.priority;break;case"enabled":n=Number(a.enabled)-Number(d.enabled);break;case"online":n=Number(a.online)-Number(d.online);break;case"expiration":n=a.expirationDays-d.expirationDays;break;default:n=0}return n===0&&(n=a.index-d.index),n*l}),t},[C,B,he,W]),z=C==="all"&&W==="priority"&&he==="asc",g=(ls=Vs.data)==null?void 0:ls.data,Es=o.useMemo(()=>{const t=(g==null?void 0:g.status)||"stopped";return t==="healthy"?s("users.telemetry.healthy",{defaultValue:"Healthy"}):t==="degraded"?s("users.telemetry.degraded",{defaultValue:"Degraded"}):t==="stale"?s("users.telemetry.stale",{defaultValue:"Stale"}):t==="starting"?s("users.telemetry.starting",{defaultValue:"Starting"}):s("users.telemetry.stopped",{defaultValue:"Stopped"})},[s,g==null?void 0:g.status]),Ls=o.useMemo(()=>!g||g.lagMs===null||g.lagMs===void 0?s("users.telemetry.noLag",{defaultValue:"No lag data yet"}):s("users.telemetry.lag",{defaultValue:"Lag {{seconds}}s",seconds:Math.max(0,Math.round(g.lagMs/1e3))}),[s,g]);if(gs)return e.jsx("div",{className:"flex h-96 items-center justify-center",children:e.jsx("div",{className:"h-12 w-12 animate-spin rounded-full border-4 border-line/70 border-t-brand-500"})});if(!r)return e.jsxs("div",{className:"py-12 text-center",children:[e.jsx("p",{className:"text-muted",children:s("users.detail.notFound",{defaultValue:"User not found"})}),e.jsx(j,{className:"mt-4",onClick:()=>K("/users"),children:s("users.detail.backToUsers",{defaultValue:"Back to Users"})})]});const Ks=t=>{if(W===t){te(l=>l==="asc"?"desc":"asc");return}ye(t),te("asc")},L=(t,l)=>{const a=W===l;return e.jsxs("button",{type:"button",className:`inline-flex items-center gap-1 rounded px-1 py-0.5 transition-colors ${a?"text-foreground":"text-muted hover:text-foreground"}`,onClick:()=>Ks(l),children:[e.jsx("span",{children:t}),e.jsx(fs,{className:`h-3.5 w-3.5 ${a?"opacity-100":"opacity-40"}`})]})},ke=t=>e.jsxs("span",{className:`inline-flex items-center gap-1.5 rounded-full px-2.5 py-1 text-xs ${t?"bg-emerald-500/15 text-emerald-300":"bg-zinc-500/15 text-zinc-300"}`,children:[e.jsxs("span",{className:"relative inline-flex h-2.5 w-2.5",children:[t?e.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-emerald-400 opacity-70"}):null,e.jsx("span",{className:`relative inline-flex h-2.5 w-2.5 rounded-full ${t?"bg-emerald-400":"bg-zinc-400"}`})]}),e.jsx("span",{children:t?s("common.online",{defaultValue:"Online"}):s("common.offline",{defaultValue:"Offline"})})]}),Us=(t,l)=>{const a=t>0,d=l>0?s("users.keysActive",{defaultValue:"Keys active {{online}}/{{total}}",online:t,total:l}):s("users.detail.noKeysEnabled",{defaultValue:"No keys enabled"});return e.jsxs("span",{className:`inline-flex items-center gap-1.5 rounded-full px-2.5 py-1 text-xs font-medium ${a?"bg-emerald-500/15 text-emerald-300":"bg-panel/60 text-muted"}`,title:d,children:[e.jsxs("span",{className:"relative inline-flex h-2.5 w-2.5",children:[a?e.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-emerald-400 opacity-70"}):null,e.jsx("span",{className:`relative inline-flex h-2.5 w-2.5 rounded-full ${a?"bg-emerald-400":"bg-zinc-400"}`})]}),e.jsx("span",{children:d})]})},We=t=>{const l=[{key:"enabled",dotClass:"bg-sky-400",value:t.enabled?1:0,label:s("common.enabled",{defaultValue:"Enabled"})},{key:"disabled",dotClass:"bg-rose-400",value:t.enabled?0:1,label:s("common.disabled",{defaultValue:"Disabled"})},{key:"online",dotClass:"bg-emerald-400",value:t.online?1:0,label:s("common.online",{defaultValue:"Online"})}];return e.jsx("div",{className:"mt-1 flex items-center gap-2",children:l.map(a=>e.jsxs("span",{title:a.label,className:"inline-flex items-center gap-1 rounded-full border border-line/60 bg-panel/65 px-1.5 py-0.5 text-[10px] font-medium text-muted",children:[e.jsx("span",{className:`h-1.5 w-1.5 rounded-full ${a.dotClass}`}),e.jsx("span",{children:a.value})]},`${t.relation.id}-${a.key}`))})},Rs=()=>{P({type:"reset-traffic"})},Fs=()=>{P({type:"delete-user"})},Je=async()=>{try{const t=await Ve.mutateAsync({id:r.id,payload:{windowMinutes:60,portProbeTimeoutMs:1200}});if(!(t!=null&&t.data))throw new Error(s("users.detail.diagnostics.empty",{defaultValue:"Diagnostics returned no data."}));_e(t.data);const l=t.data.summary||{pass:0,warn:0,fail:0},a=s("users.detail.diagnostics.summary",{defaultValue:"PASS {{pass}} • WARN {{warn}} • FAIL {{fail}}",pass:l.pass,warn:l.warn,fail:l.fail});l.fail>0||l.warn>0?u.warning(s("users.detail.diagnostics.title",{defaultValue:"Diagnostics completed"}),a):u.success(s("users.detail.diagnostics.title",{defaultValue:"Diagnostics completed"}),a)}catch(t){u.error(s("common.error",{defaultValue:"Error"}),(t==null?void 0:t.message)||s("users.detail.diagnostics.failed",{defaultValue:"Failed to run diagnostics"}))}},Ie=async(t,l)=>await kt(l)?(U(t),window.setTimeout(()=>U(""),1800),!0):(u.error(s("common.error",{defaultValue:"Error"}),s("users.detail.toast.copyFailed",{defaultValue:"Copy failed. Please copy manually."})),!1),$s=t=>{const l=t.map(n=>({id:String(n.id||""),content:String(n.content||"").trim()})).filter(n=>!!n.content),a=l.find(n=>/^(vless|vmess|trojan|ss|socks5|http|wireguard):\/\//i.test(n.content));if(a)return a.content;const d=l.find(n=>n.id.includes("url"));return d?d.content:r.subscriptionToken?`${window.location.origin}/sub/${r.subscriptionToken}?target=v2ray`:""},Os=async t=>{var l;if(t.inboundId){Fe(t.inboundId);try{const a=await rt.get(`/inbounds/${t.inboundId}/client-templates`,{params:{userId:r.id}}),d=((l=a==null?void 0:a.data)==null?void 0:l.templates)||[],n=$s(d);if(!n)throw new Error(s("users.detail.toast.noKeyUrl",{defaultValue:"No key URL available for this inbound"}));if(!await Ie(`key-${t.inboundId}`,n))throw new Error(s("users.detail.toast.copyKeyFailed",{defaultValue:"Failed to copy key"}))}catch(a){u.error(s("common.error",{defaultValue:"Error"}),(a==null?void 0:a.message)||s("users.detail.toast.copyKeyFailed",{defaultValue:"Failed to copy key"}))}finally{Fe(null)}}},De=async t=>{if(t.inboundId){Re(t.inboundId);try{await js.mutateAsync({id:r.id,inboundId:t.inboundId,enabled:!t.enabled}),T()}catch(l){u.error(s("common.error",{defaultValue:"Error"}),(l==null?void 0:l.message)||s("users.detail.toast.keyStatusFailed",{defaultValue:"Failed to update key status"}))}finally{Re(null)}}},Xe=async(t,l)=>{if(!t.inboundId)return;const a=Number.isInteger(Number(t.priority))?Number(t.priority):100,d=Math.max(1,Math.min(9999,a+l));if(d!==a){$e(t.inboundId);try{await vs.mutateAsync({id:r.id,inboundId:t.inboundId,priority:d}),T()}catch(n){u.error(s("common.error",{defaultValue:"Error"}),(n==null?void 0:n.message)||s("users.detail.toast.keyPriorityFailed",{defaultValue:"Failed to update key priority"}))}finally{$e(null)}}},Bs=()=>{const t=[{key:"reset-traffic",label:re.isPending?s("users.detail.actions.resettingTraffic",{defaultValue:"Resetting traffic..."}):s("users.detail.actions.resetTraffic",{defaultValue:"Reset traffic"}),icon:St,disabled:re.isPending,onClick:()=>Rs()},{key:"delete-user",label:ne.isPending?s("users.detail.actions.deletingUser",{defaultValue:"Deleting user..."}):s("users.detail.actions.deleteUser",{defaultValue:"Delete user"}),icon:At,tone:"danger",disabled:ne.isPending,onClick:()=>Fs()}];return e.jsx(os,{items:t,ariaLabel:s("common.moreActions",{defaultValue:"More actions"}),triggerClassName:"inline-flex items-center rounded-xl border border-line/70 bg-card/75 px-3 py-2 text-foreground transition hover:bg-panel/60 focus:outline-none focus:ring-2 focus:ring-brand-500/40 disabled:cursor-not-allowed disabled:opacity-50",children:e.jsxs("span",{className:"inline-flex items-center gap-2",children:[e.jsx(cs,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:s("common.actions",{defaultValue:"Actions"})})]})})},Ye=(t,l={})=>{const a=t.relation,d=!!l.mobile,n=Number.parseInt(String(a.inboundId||0),10),x=n>0&&xs===n,m=n>0&&me===n,b=n>0&&ps===n,Pe=[{key:"templates",label:s("users.detail.keyMenu.templates",{defaultValue:"Client templates"}),icon:Tt,disabled:!a.inbound,onClick:()=>Ue(a.inbound)},{key:"copy",label:x?s("users.detail.keyMenu.copyingKey",{defaultValue:"Copying key..."}):s("users.detail.keyMenu.copyKeyUrl",{defaultValue:"Copy key URL"}),icon:Ae,disabled:n<=0||x,onClick:()=>void Os(a)},{key:"toggle",label:m?s("users.detail.keyMenu.updating",{defaultValue:"Updating..."}):a.enabled?s("users.detail.keyMenu.disableKey",{defaultValue:"Disable key"}):s("users.detail.keyMenu.enableKey",{defaultValue:"Enable key"}),icon:a.enabled?ot:ct,disabled:n<=0||m,onClick:()=>void De(a)},{key:"move-up",label:s("users.detail.keyMenu.moveUp",{defaultValue:"Move up (higher priority)"}),icon:Mt,disabled:n<=0||b||S||t.priority<=1,onClick:()=>void Xe(a,-1)},{key:"move-down",label:s("users.detail.keyMenu.moveDown",{defaultValue:"Move down (lower priority)"}),icon:Ct,disabled:n<=0||b||S||t.priority>=9999,onClick:()=>void Xe(a,1)},{key:"open-inbounds",label:s("users.detail.keyMenu.openInbounds",{defaultValue:"Open inbounds page"}),icon:Et,onClick:()=>K("/inbounds?tab=inbounds")}];return e.jsx(os,{items:Pe,ariaLabel:s("common.moreActions",{defaultValue:"More actions"}),triggerClassName:`rounded-lg border border-line/60 bg-card/70 px-2 py-1 text-foreground transition hover:bg-panel/70 focus:outline-none focus:ring-2 focus:ring-brand-500/40 disabled:cursor-not-allowed disabled:opacity-50 ${d?"inline-flex h-10 w-10 items-center justify-center":"inline-flex h-8 w-8 items-center justify-center"}`,children:e.jsx(cs,{className:"h-4 w-4"})})},zs=async()=>{if((r.inbounds||[]).filter(l=>Number.isInteger(Number(l.inboundId))&&Number(l.inboundId)>0).length===0){u.error(s("common.error",{defaultValue:"Error"}),s("users.detail.toast.noKeys",{defaultValue:"No keys available for this user."}));return}ee(!0);try{const a=(await ce.previewUserInboundPatternReorder(r.id,"myanmar")).data;if(!a)throw new Error(s("users.detail.toast.previewGenerateFailed",{defaultValue:"Failed to generate preview"}));if((a.matchedKeys||0)===0){u.error(s("common.error",{defaultValue:"Error"}),s("users.detail.toast.noMyanmarProfiles",{defaultValue:"No Myanmar-compatible profiles found (expected REALITY / VLESS WS TLS / TROJAN WS TLS)."}));return}ge({totalKeys:a.totalKeys??0,matchedKeys:a.matchedKeys??0,changedKeys:a.changedKeys??0,currentTop3:a.currentTop3||[],newTop3:a.newTop3||[]})}catch(l){u.error(s("common.error",{defaultValue:"Error"}),(l==null?void 0:l.message)||s("users.detail.toast.myanmarPreviewFailed",{defaultValue:"Failed to preview Myanmar priority order"}))}finally{ee(!1)}},_s=async()=>{if(p){ee(!0);try{const l=(await ce.reorderUserInboundsByPattern(r.id,{pattern:"myanmar"})).data;ye("priority"),te("asc"),be("all"),ge(null),T(),u.success(s("common.success",{defaultValue:"Success"}),s("users.detail.toast.myanmarApplied",{defaultValue:"Promoted {{count}} matching key(s).",count:(l==null?void 0:l.matchedKeys)??p.matchedKeys??0}))}catch(t){u.error(s("common.error",{defaultValue:"Error"}),(t==null?void 0:t.message)||s("users.detail.toast.myanmarApplyFailed",{defaultValue:"Failed to apply Myanmar priority order"}))}finally{ee(!1)}}},Qs=async()=>{if(!r)return;if((r.inbounds||[]).filter(l=>Number.isInteger(Number(l.inboundId))&&Number(l.inboundId)>0).length===0){u.error(s("common.error",{defaultValue:"Error"}),s("users.detail.toast.noKeys",{defaultValue:"No keys available for this user."}));return}se(!0);try{const a=(await ce.previewUserInboundQualityReorder(r.id,{windowMinutes:60})).data;if(!a)throw new Error(s("users.detail.toast.previewGenerateFailed",{defaultValue:"Failed to generate preview"}));if((a.scoredKeys||0)===0){u.warning(s("common.warning",{defaultValue:"Warning"}),s("users.detail.toast.noTelemetry",{defaultValue:"No recent connections were detected. Generate traffic on at least one key and try again."}));return}const d=(a.preview||[]).slice(0,10).map(n=>{const x=n.score===null?"-":n.score.toFixed(0);return`P${n.toPriority} • ${n.key} • score ${x} • connect ${n.connectSuccesses} • reject ${n.limitRejects} • reconnect ${n.reconnects}`});je({windowMinutes:a.windowMinutes??60,totalKeys:a.totalKeys??0,scoredKeys:a.scoredKeys??0,changedKeys:a.changedKeys??0,currentTop3:a.currentTop3||[],newTop3:a.newTop3||[],previewLines:d})}catch(l){u.error(s("common.error",{defaultValue:"Error"}),(l==null?void 0:l.message)||s("users.detail.toast.qualityPreviewFailed",{defaultValue:"Failed to generate quality preview"}))}finally{se(!1)}},Hs=async()=>{if(!(!f||!r)){se(!0);try{const l=(await ce.reorderUserInboundsByQuality(r.id,{windowMinutes:f.windowMinutes})).data;ye("priority"),te("asc"),be("all"),je(null),T(),u.success(s("common.success",{defaultValue:"Success"}),s("users.detail.toast.qualityApplied",{defaultValue:"Reordered {{count}} key(s) with telemetry.",count:(l==null?void 0:l.scoredKeys)??f.scoredKeys}))}catch(t){u.error(s("common.error",{defaultValue:"Error"}),(t==null?void 0:t.message)||s("users.detail.toast.qualityApplyFailed",{defaultValue:"Failed to apply quality ordering"}))}finally{se(!1)}}},q=()=>{Be(null),pe(null)},Gs=t=>{!z||S||(Be(t),pe(t))},Ws=(t,l)=>{!z||S||R===null||(t.preventDefault(),ze!==l&&pe(l))},Js=async t=>{if(!z||S||R===null){q();return}if(R===t){q();return}const l=oe.filter(b=>Number.isInteger(Number(b.relation.inboundId))&&Number(b.relation.inboundId)>0),a=l.findIndex(b=>b.relation.inboundId===R),d=l.findIndex(b=>b.relation.inboundId===t);if(a<0||d<0){q();return}const n=[...l],[x]=n.splice(a,1);n.splice(d,0,x);const m=n.map((b,Pe)=>({inboundId:Number(b.relation.inboundId),priority:100+Pe,enabled:!!b.relation.enabled}));Oe(!0);try{await Ns.mutateAsync({id:r.id,assignments:m}),T()}catch(b){u.error(s("common.error",{defaultValue:"Error"}),(b==null?void 0:b.message)||s("users.detail.toast.reorderFailed",{defaultValue:"Failed to reorder keys"}))}finally{Oe(!1),q()}},Xs=t=>{P({type:"revoke-device",fingerprint:t})},qe=(i==null?void 0:i.type)==="reset-traffic"?re.isPending:(i==null?void 0:i.type)==="delete-user"?ne.isPending:(i==null?void 0:i.type)==="revoke-device"?Ne.isPending:!1,Ys=async()=>{if(i)try{if(i.type==="reset-traffic")await re.mutateAsync(r.id),u.success(s("common.success",{defaultValue:"Success"}),s("users.detail.toast.trafficReset",{defaultValue:"User traffic counters were reset."})),T();else if(i.type==="delete-user"){await ne.mutateAsync(r.id),u.success(s("common.success",{defaultValue:"Success"}),s("users.detail.toast.userDeleted",{defaultValue:"User was deleted successfully."})),P(null),K("/users");return}else i.type==="revoke-device"&&(await Ne.mutateAsync({id:r.id,fingerprint:i.fingerprint}),u.success(s("common.success",{defaultValue:"Success"}),s("users.detail.toast.deviceRevoked",{defaultValue:"Device session was revoked."})),k.refetch(),O.refetch());P(null)}catch(t){i.type==="reset-traffic"?u.error(s("common.error",{defaultValue:"Error"}),(t==null?void 0:t.message)||s("users.detail.toast.resetFailed",{defaultValue:"Failed to reset traffic"})):i.type==="delete-user"?u.error(s("common.error",{defaultValue:"Error"}),(t==null?void 0:t.message)||s("users.detail.toast.deleteFailed",{defaultValue:"Failed to delete user"})):u.error(s("common.error",{defaultValue:"Error"}),(t==null?void 0:t.message)||s("users.detail.toast.revokeFailed",{defaultValue:"Failed to revoke device session"}))}},qs=(i==null?void 0:i.type)==="reset-traffic"?s("users.actions.resetTrafficTitle",{defaultValue:"Reset traffic?"}):(i==null?void 0:i.type)==="delete-user"?s("users.detail.confirm.deleteTitle",{defaultValue:"Delete user?"}):(i==null?void 0:i.type)==="revoke-device"?s("users.devices.revokeTitle",{defaultValue:"Revoke Device Session"}):"",Zs=(i==null?void 0:i.type)==="reset-traffic"?s("users.actions.resetTrafficDescription",{defaultValue:"Reset this user's upload/download counters."}):(i==null?void 0:i.type)==="delete-user"?s("users.detail.confirm.deleteDescription",{defaultValue:"Are you sure you want to delete this user? This action cannot be undone."}):(i==null?void 0:i.type)==="revoke-device"?s("users.devices.revokeDescription",{defaultValue:"Revoke this device? It will need to reconnect."}):"",et=(i==null?void 0:i.type)==="delete-user"?s("common.delete",{defaultValue:"Delete"}):(i==null?void 0:i.type)==="reset-traffic"?s("common.reset",{defaultValue:"Reset"}):s("common.revoke",{defaultValue:"Revoke"}),st=(i==null?void 0:i.type)==="delete-user"?"danger":"primary",tt=()=>{const t={ACTIVE:"success",EXPIRED:"danger",DISABLED:"warning",LIMITED:"warning"};return e.jsx(Se,{variant:t[r.status],children:r.status})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[e.jsx(j,{variant:"ghost",onClick:()=>K("/users"),children:e.jsx(Lt,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground sm:text-3xl",children:r.email}),e.jsx("p",{className:"mt-1 text-sm text-muted",children:s("users.detail.subtitle",{defaultValue:"User details & access keys"})}),e.jsx("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:Us(Cs,Ms)})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 sm:gap-3",children:[e.jsxs(j,{variant:"secondary",onClick:()=>{window.open(`/user/${r.subscriptionToken}`,"_blank")},children:[e.jsx(Dt,{className:"mr-2 h-4 w-4"}),s("users.detail.openDashboard",{defaultValue:"User Dashboard"})]}),e.jsxs(j,{variant:"secondary",onClick:()=>G(!0),children:[e.jsx(Pt,{className:"mr-2 h-4 w-4"}),s("common.edit",{defaultValue:"Edit"})]}),e.jsxs(j,{variant:"secondary",loading:Ve.isPending,onClick:()=>{Je()},children:[e.jsx(Te,{className:"mr-2 h-4 w-4"}),s("users.detail.runDiagnostics",{defaultValue:"Run Diagnostics"})]}),Bs()]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-5",children:[e.jsxs(v,{children:[e.jsx("p",{className:"text-sm text-muted",children:s("common.status",{defaultValue:"Status"})}),e.jsx("div",{className:"mt-2",children:tt()})]}),e.jsxs(v,{children:[e.jsx("p",{className:"text-sm text-muted",children:s("common.online",{defaultValue:"Online"})}),e.jsx("div",{className:"mt-2",children:ke(X)}),e.jsx("p",{className:"mt-1 text-xs text-muted",children:Ds})]}),e.jsxs(v,{children:[e.jsx("p",{className:"text-sm text-muted",children:s("users.dataUsed",{defaultValue:"Data Used"})}),e.jsx("p",{className:"mt-1 text-2xl font-bold text-foreground",children:w(J)}),e.jsx("p",{className:"mt-1 text-xs text-muted",children:s("users.detail.dataLimitCaption",{defaultValue:"Limit: {{limit}}",limit:w(V)})})]}),e.jsxs(v,{children:[e.jsx("p",{className:"text-sm text-muted",children:s("users.detail.remaining",{defaultValue:"Remaining"})}),e.jsx("p",{className:"mt-1 text-2xl font-bold text-foreground",children:w(Qe)}),e.jsx("p",{className:"mt-1 text-xs text-muted",children:s("users.detail.remainingPercentLeft",{defaultValue:"{{percent}}% left",percent:Is.toFixed(1)})})]}),e.jsxs(v,{children:[e.jsx("p",{className:"text-sm text-muted",children:Ge?s("common.expiry",{defaultValue:"Expiry"}):s("users.detail.expiresIn",{defaultValue:"Expires in"})}),Ge?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"mt-2 text-base font-semibold text-foreground",children:s("users.startOnFirstConnect",{defaultValue:"Starts on first connect"})}),e.jsx("p",{className:"mt-1 text-xs text-muted",children:s("users.detail.expiry.afterFirstConnect",{defaultValue:"{{days}} days after first connect",days:ie})})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"mt-1 text-2xl font-bold text-foreground",children:s("users.detail.expiry.daysValue",{defaultValue:"{{count}} days",count:ie})}),e.jsx("p",{className:"mt-1 text-xs text-muted",children:_(r.expireDate)})]})]})]}),e.jsxs(v,{children:[e.jsxs("div",{className:"mb-4 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-foreground",children:s("users.detail.diagnostics.panelTitle",{defaultValue:"Connection diagnostics"})}),e.jsx("p",{className:"mt-1 text-sm text-muted",children:s("users.detail.diagnostics.panelSubtitle",{defaultValue:"Run health checks for runtime, key config, port reachability, and live sessions."})})]}),e.jsxs(j,{size:"sm",variant:"secondary",loading:Ve.isPending,onClick:()=>{Je()},children:[e.jsx(Te,{className:"mr-2 h-4 w-4"}),s("users.detail.runDiagnostics",{defaultValue:"Run Diagnostics"})]})]}),e.jsxs("div",{className:"mb-4 rounded-xl border border-line/70 bg-panel/55 p-3 text-xs text-muted",children:[e.jsxs("p",{children:[s("users.telemetry.label",{defaultValue:"Telemetry"}),":"," ",e.jsx("span",{className:"font-medium text-foreground",children:Es})," • ",Ls]}),g!=null&&g.lastErrorMessage?e.jsx("p",{className:"mt-1 text-rose-300",children:s("users.telemetry.lastError",{defaultValue:"Last error: {{message}}",message:g.lastErrorMessage})}):null]}),$?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 sm:grid-cols-4",children:[e.jsxs("div",{className:"rounded-lg border border-line/70 bg-card/70 p-3",children:[e.jsx("p",{className:"text-[11px] uppercase tracking-wide text-muted",children:s("common.pass",{defaultValue:"Pass"})}),e.jsx("p",{className:"mt-1 text-lg font-semibold text-emerald-400",children:$.summary.pass})]}),e.jsxs("div",{className:"rounded-lg border border-line/70 bg-card/70 p-3",children:[e.jsx("p",{className:"text-[11px] uppercase tracking-wide text-muted",children:s("common.warning",{defaultValue:"Warning"})}),e.jsx("p",{className:"mt-1 text-lg font-semibold text-amber-300",children:$.summary.warn})]}),e.jsxs("div",{className:"rounded-lg border border-line/70 bg-card/70 p-3",children:[e.jsx("p",{className:"text-[11px] uppercase tracking-wide text-muted",children:s("common.fail",{defaultValue:"Fail"})}),e.jsx("p",{className:"mt-1 text-lg font-semibold text-rose-400",children:$.summary.fail})]}),e.jsxs("div",{className:"rounded-lg border border-line/70 bg-card/70 p-3",children:[e.jsx("p",{className:"text-[11px] uppercase tracking-wide text-muted",children:s("common.total",{defaultValue:"Total"})}),e.jsx("p",{className:"mt-1 text-lg font-semibold text-foreground",children:$.summary.total})]})]}),e.jsx("div",{className:"space-y-2",children:($.checks||[]).map(t=>e.jsxs("div",{className:"rounded-xl border border-line/70 bg-panel/45 p-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[e.jsx("p",{className:"font-medium text-foreground",children:t.label}),e.jsx("span",{className:`inline-flex rounded-full px-2 py-0.5 text-xs font-semibold ${t.status==="PASS"?"bg-emerald-500/20 text-emerald-300":t.status==="WARN"?"bg-amber-500/20 text-amber-300":"bg-rose-500/20 text-rose-300"}`,children:t.status})]}),e.jsx("p",{className:"mt-1 text-sm text-muted",children:t.details}),t.recommendedAction?e.jsx("p",{className:"mt-1 text-xs text-amber-300",children:t.recommendedAction}):null]},t.id))})]}):e.jsx("div",{className:"rounded-xl border border-line/70 bg-panel/45 p-4 text-sm text-muted",children:s("users.detail.diagnostics.empty",{defaultValue:'No diagnostics report yet. Click "Run Diagnostics" to generate one.'})})]}),e.jsxs(v,{children:[e.jsx("h2",{className:"mb-4 text-xl font-bold text-foreground",children:s("users.detail.userInfoTitle",{defaultValue:"User Information"})}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted",children:s("users.email",{defaultValue:"Email"})}),e.jsx("p",{className:"mt-1 font-medium text-foreground",children:r.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted",children:s("users.uuid",{defaultValue:"UUID"})}),e.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[e.jsx("code",{className:"rounded-lg border border-line/70 bg-panel/70 px-2 py-1 font-mono text-sm text-foreground",children:r.uuid}),e.jsx("button",{onClick:()=>{Ie("uuid",r.uuid)},className:"rounded p-1 transition-colors hover:bg-card","aria-label":s("users.detail.copyUuid",{defaultValue:"Copy UUID"}),children:M==="uuid"?e.jsx(us,{className:"h-4 w-4 text-emerald-500"}):e.jsx(Ae,{className:"h-4 w-4 text-muted"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted",children:s("auth.password",{defaultValue:"Password"})}),e.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[e.jsx("code",{className:"rounded-lg border border-line/70 bg-panel/70 px-2 py-1 font-mono text-sm text-foreground",children:r.password}),e.jsx("button",{onClick:()=>{Ie("password",r.password)},className:"rounded p-1 transition-colors hover:bg-card","aria-label":s("users.detail.copyPassword",{defaultValue:"Copy password"}),children:M==="password"?e.jsx(us,{className:"h-4 w-4 text-emerald-500"}):e.jsx(Ae,{className:"h-4 w-4 text-muted"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted",children:s("users.detail.createdAt",{defaultValue:"Created at"})}),e.jsx("p",{className:"mt-1 text-foreground",children:_(r.createdAt)})]}),r.note?e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm text-muted",children:s("users.note",{defaultValue:"Note"})}),e.jsx("p",{className:"mt-1 text-foreground",children:r.note})]}):null]})]}),e.jsxs(v,{children:[e.jsxs("div",{className:"mb-4 flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-foreground",children:s("users.detail.effectiveInbounds.title",{defaultValue:"Effective inbound access"})}),e.jsx("p",{className:"mt-1 text-sm text-muted",children:s("users.detail.effectiveInbounds.subtitle",{defaultValue:"Combined view of direct assignments and inherited group mappings."})})]}),e.jsxs(j,{size:"sm",variant:"secondary",loading:ae.isFetching,onClick:()=>{ae.refetch()},children:[e.jsx(ue,{className:"mr-2 h-4 w-4"}),s("common.refresh",{defaultValue:"Refresh"})]})]}),ae.isLoading?e.jsx("div",{className:"py-4 text-sm text-muted",children:s("users.detail.effectiveInbounds.loading",{defaultValue:"Loading effective access..."})}):!we||we.effectiveInbounds.length===0?e.jsx("div",{className:"rounded-xl border border-line/70 bg-panel/55 p-4 text-sm text-muted",children:s("users.detail.effectiveInbounds.empty",{defaultValue:"No effective inbounds found for this user."})}):e.jsx("div",{className:"space-y-3",children:we.effectiveInbounds.map(t=>e.jsxs("div",{className:"rounded-xl border border-line/70 bg-panel/55 p-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold text-foreground",children:[t.inbound.protocol," • ",t.inbound.port]}),e.jsx("p",{className:"text-sm text-muted",children:t.inbound.remark||t.inbound.tag})]}),e.jsx(Se,{variant:t.inbound.enabled?"success":"warning",children:t.inbound.enabled?s("users.detail.effectiveInbounds.badgeEnabled",{defaultValue:"Inbound enabled"}):s("users.detail.effectiveInbounds.badgeDisabled",{defaultValue:"Inbound disabled"})})]}),e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:t.sources.map((l,a)=>e.jsx("span",{className:`inline-flex rounded-full px-2.5 py-1 text-xs font-medium ${l.type==="DIRECT"?"bg-brand-500/20 text-brand-200":"bg-violet-500/20 text-violet-200"}`,children:l.type==="DIRECT"?s("users.detail.effectiveInbounds.sourceDirect",{defaultValue:"Direct"}):s("users.detail.effectiveInbounds.sourceGroup",{defaultValue:"Group: {{name}}",name:l.groupName||String(l.groupId)})},`effective-source-${t.inboundId}-${a}`))})]},`effective-inbound-${t.inboundId}`))})]}),e.jsxs(v,{children:[e.jsxs("div",{className:"mb-4 flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-foreground",children:s("users.detail.policy.title",{defaultValue:"Effective policy"})}),e.jsx("p",{className:"mt-1 text-sm text-muted",children:s("users.detail.policy.subtitle",{defaultValue:"Compare direct user policy with inherited group policy overrides."})})]}),e.jsxs(j,{size:"sm",variant:"secondary",loading:le.isFetching,onClick:()=>{le.refetch()},children:[e.jsx(ue,{className:"mr-2 h-4 w-4"}),s("common.refresh",{defaultValue:"Refresh"})]})]}),le.isLoading?e.jsx("div",{className:"py-4 text-sm text-muted",children:s("users.detail.policy.loading",{defaultValue:"Loading effective policy..."})}):c?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"overflow-x-auto rounded-xl border border-line/70 bg-panel/55",children:e.jsxs("table",{className:"min-w-[760px] w-full text-sm",children:[e.jsx("thead",{className:"bg-panel/80 text-xs uppercase tracking-wide text-muted",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left",children:s("users.detail.policy.table.field",{defaultValue:"Field"})}),e.jsx("th",{className:"px-4 py-3 text-left",children:s("users.detail.policy.table.direct",{defaultValue:"Direct"})}),e.jsx("th",{className:"px-4 py-3 text-left",children:s("users.detail.policy.table.inherited",{defaultValue:"Inherited"})}),e.jsx("th",{className:"px-4 py-3 text-left",children:s("users.detail.policy.table.effective",{defaultValue:"Effective"})})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-t border-line/70",children:[e.jsx("td",{className:"px-4 py-3 font-medium text-foreground",children:s("users.dataLimit",{defaultValue:"Data Limit"})}),e.jsx("td",{className:"px-4 py-3 text-foreground",children:w(Number(c.directPolicy.dataLimit||0))}),e.jsx("td",{className:"px-4 py-3 text-foreground",children:c.inheritedPolicy.dataLimit!==null?w(Number(c.inheritedPolicy.dataLimit||0)):s("common.noOverride",{defaultValue:"No override"})}),e.jsxs("td",{className:"px-4 py-3 text-foreground",children:[w(Number(c.effectivePolicy.dataLimit||0)),c.drift.dataLimit?e.jsx("span",{className:"ml-2 rounded-full bg-amber-500/20 px-2 py-0.5 text-xs text-amber-300",children:s("common.drift",{defaultValue:"Drift"})}):null]})]}),e.jsxs("tr",{className:"border-t border-line/70",children:[e.jsx("td",{className:"px-4 py-3 font-medium text-foreground",children:s("common.expiry",{defaultValue:"Expiry"})}),e.jsx("td",{className:"px-4 py-3 text-foreground",children:_(c.directPolicy.expireDate)}),e.jsx("td",{className:"px-4 py-3 text-foreground",children:c.inheritedPolicy.expireDate?_(c.inheritedPolicy.expireDate):s("common.noOverride",{defaultValue:"No override"})}),e.jsxs("td",{className:"px-4 py-3 text-foreground",children:[_(c.effectivePolicy.expireDate),c.drift.expireDate?e.jsx("span",{className:"ml-2 rounded-full bg-amber-500/20 px-2 py-0.5 text-xs text-amber-300",children:s("common.drift",{defaultValue:"Drift"})}):null]})]}),e.jsxs("tr",{className:"border-t border-line/70",children:[e.jsx("td",{className:"px-4 py-3 font-medium text-foreground",children:s("users.form.ipLimitLabel",{defaultValue:"IP Limit"})}),e.jsx("td",{className:"px-4 py-3 text-foreground",children:c.directPolicy.ipLimit}),e.jsx("td",{className:"px-4 py-3 text-foreground",children:c.inheritedPolicy.ipLimit??s("common.noOverride",{defaultValue:"No override"})}),e.jsxs("td",{className:"px-4 py-3 text-foreground",children:[c.effectivePolicy.ipLimit,c.drift.ipLimit?e.jsx("span",{className:"ml-2 rounded-full bg-amber-500/20 px-2 py-0.5 text-xs text-amber-300",children:s("common.drift",{defaultValue:"Drift"})}):null]})]}),e.jsxs("tr",{className:"border-t border-line/70",children:[e.jsx("td",{className:"px-4 py-3 font-medium text-foreground",children:s("common.status",{defaultValue:"Status"})}),e.jsx("td",{className:"px-4 py-3 text-foreground",children:c.directPolicy.status}),e.jsx("td",{className:"px-4 py-3 text-foreground",children:c.inheritedPolicy.status||s("common.noOverride",{defaultValue:"No override"})}),e.jsxs("td",{className:"px-4 py-3 text-foreground",children:[c.effectivePolicy.status,c.drift.status?e.jsx("span",{className:"ml-2 rounded-full bg-amber-500/20 px-2 py-0.5 text-xs text-amber-300",children:s("common.drift",{defaultValue:"Drift"})}):null]})]}),e.jsxs("tr",{className:"border-t border-line/70",children:[e.jsx("td",{className:"px-4 py-3 font-medium text-foreground",children:s("users.detail.policy.table.trafficReset",{defaultValue:"Traffic reset"})}),e.jsxs("td",{className:"px-4 py-3 text-foreground",children:[c.directPolicy.trafficResetPeriod,c.directPolicy.trafficResetDay?` @${c.directPolicy.trafficResetDay}`:""]}),e.jsx("td",{className:"px-4 py-3 text-foreground",children:c.inheritedPolicy.trafficResetPeriod?`${c.inheritedPolicy.trafficResetPeriod}${c.inheritedPolicy.trafficResetDay?` @${c.inheritedPolicy.trafficResetDay}`:""}`:s("common.noOverride",{defaultValue:"No override"})}),e.jsxs("td",{className:"px-4 py-3 text-foreground",children:[c.effectivePolicy.trafficResetPeriod,c.effectivePolicy.trafficResetDay?` @${c.effectivePolicy.trafficResetDay}`:""]})]})]})]})}),e.jsxs("div",{children:[e.jsx("p",{className:"mb-2 text-xs font-semibold uppercase tracking-[0.08em] text-muted",children:s("users.detail.policy.groupSources",{defaultValue:"Group policy sources"})}),e.jsx("div",{className:"flex flex-wrap gap-2",children:c.groups.length===0?e.jsx("span",{className:"text-sm text-muted",children:s("users.detail.policy.noGroups",{defaultValue:"No active groups assigned"})}):c.groups.map(t=>e.jsx("span",{className:"rounded-full border border-line/70 bg-card/70 px-3 py-1 text-xs text-foreground",children:t.name},`policy-group-${t.id}`))})]})]}):e.jsx("div",{className:"rounded-xl border border-line/70 bg-panel/55 p-4 text-sm text-muted",children:s("users.detail.policy.unavailable",{defaultValue:"Effective policy is unavailable for this user."})})]}),e.jsxs(v,{className:"p-0",children:[e.jsxs("div",{className:"border-b border-line/70 px-5 py-4",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-foreground",children:s("users.detail.keys.title",{defaultValue:"Access keys"})}),e.jsx("p",{className:"mt-1 text-sm text-muted",children:s("users.detail.keys.subtitle",{defaultValue:"Manage per-inbound keys, status, online visibility, and client templates."})})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("select",{value:C,onChange:t=>be(t.target.value),className:"rounded-lg border border-line/70 bg-card/80 px-3 py-2 text-xs text-foreground focus:border-brand-500/60 focus:outline-none focus:ring-2 focus:ring-brand-500/30",children:[e.jsx("option",{value:"all",children:s("users.detail.keys.filter.all",{defaultValue:"All keys"})}),e.jsx("option",{value:"enabled",children:s("common.enabled",{defaultValue:"Enabled"})}),e.jsx("option",{value:"disabled",children:s("common.disabled",{defaultValue:"Disabled"})}),e.jsx("option",{value:"online",children:s("common.online",{defaultValue:"Online"})}),e.jsx("option",{value:"offline",children:s("common.offline",{defaultValue:"Offline"})})]}),e.jsx("select",{value:String(A),onChange:t=>ys(Number(t.target.value)),className:"rounded-lg border border-line/70 bg-card/80 px-3 py-2 text-xs text-foreground focus:border-brand-500/60 focus:outline-none focus:ring-2 focus:ring-brand-500/30",children:$t.map(t=>e.jsxs("option",{value:t.value,children:[s("common.refresh",{defaultValue:"Refresh"})," ",t.label]},t.value))}),e.jsxs("select",{value:E,onChange:t=>hs(t.target.value),className:"rounded-lg border border-line/70 bg-card/80 px-3 py-2 text-xs text-foreground focus:border-brand-500/60 focus:outline-none focus:ring-2 focus:ring-brand-500/30",children:[e.jsx("option",{value:"comfortable",children:s("users.detail.keys.density.comfortable",{defaultValue:"Comfortable rows"})}),e.jsx("option",{value:"compact",children:s("users.detail.keys.density.compact",{defaultValue:"Compact rows"})})]}),e.jsxs(j,{size:"sm",variant:"secondary",loading:Ps,onClick:()=>{O.refetch(),k.refetch(),T()},children:[e.jsx(ue,{className:"mr-2 h-4 w-4"}),s("common.refresh",{defaultValue:"Refresh"})]}),e.jsxs(j,{size:"sm",variant:"secondary",loading:fe,disabled:S||(r.inbounds||[]).length===0,onClick:()=>{zs()},children:[e.jsx(fs,{className:"mr-2 h-4 w-4"}),s("users.myanmarPriority",{defaultValue:"Myanmar Priority"})]}),e.jsxs(j,{size:"sm",variant:"secondary",loading:xe,disabled:S||(r.inbounds||[]).length===0,onClick:()=>{Qs()},children:[e.jsx(Te,{className:"mr-2 h-4 w-4"}),s("users.autoTune",{defaultValue:"Auto-tune"})]})]})]}),e.jsx("p",{className:"mt-2 text-xs text-muted",children:z?s("users.detail.keys.dragHintEnabled",{defaultValue:"Drag rows from the Menu column to reorder key priority. The order controls subscription fallback."}):s("users.detail.keys.dragHintDisabled",{defaultValue:"Enable drag reorder by setting Filter: All keys and Sort: Priority ascending."})})]}),oe.length===0?e.jsx("div",{className:"px-5 py-8 text-sm text-muted",children:s("users.detail.keys.empty",{defaultValue:"No keys match the selected filter."})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden overflow-x-auto lg:block",children:e.jsxs("table",{className:`min-w-[1100px] w-full ${E==="compact"?"text-xs":"text-sm"}`,children:[e.jsx("thead",{className:"bg-panel/65",children:e.jsxs("tr",{className:"border-b border-line/70 text-left text-xs uppercase tracking-wide text-muted",children:[e.jsx("th",{className:I,children:s("users.detail.keys.table.menu",{defaultValue:"Menu"})}),e.jsx("th",{className:I,children:L(s("common.enabled",{defaultValue:"Enabled"}),"enabled")}),e.jsx("th",{className:I,children:L(s("common.online",{defaultValue:"Online"}),"online")}),e.jsx("th",{className:I,children:L(s("users.detail.keys.table.clientKey",{defaultValue:"Client / Key"}),"key")}),e.jsx("th",{className:I,children:L(s("users.detail.keys.table.protocol",{defaultValue:"Protocol"}),"protocol")}),e.jsx("th",{className:I,children:L(s("users.detail.keys.table.port",{defaultValue:"Port"}),"port")}),e.jsx("th",{className:I,children:L(s("users.detail.keys.table.priority",{defaultValue:"Priority"}),"priority")}),e.jsx("th",{className:I,children:s("users.detail.keys.table.traffic",{defaultValue:"Traffic"})}),e.jsx("th",{className:I,children:L(s("users.detail.keys.table.expiration",{defaultValue:"Expiration"}),"expiration")})]})}),e.jsx("tbody",{children:oe.map(t=>{const l=t.relation,a=Number.parseInt(String(l.inboundId||0),10),d=Ce(s,t.online,t.lastSeenAt,F),n=z&&a>0&&!S,x=R===a,m=ze===a&&R!==a;return e.jsxs("tr",{className:`border-b border-line/70 transition-colors hover:bg-panel/35 ${x?"bg-brand-500/10":""} ${m?"ring-1 ring-inset ring-brand-500/50":""}`,draggable:n,onDragStart:()=>{Gs(a)},onDragOver:b=>{Ws(b,a)},onDrop:()=>{Js(a)},onDragEnd:q,children:[e.jsx("td",{className:D,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`inline-flex items-center rounded p-1 ${n?"cursor-grab text-muted hover:bg-panel/70 hover:text-foreground":"text-muted/40"}`,title:z?s("users.detail.keys.dragHandleEnabled",{defaultValue:"Drag to reorder priority"}):s("users.detail.keys.dragHandleDisabled",{defaultValue:"Sort by priority ascending to enable drag reorder"}),children:e.jsx(Kt,{className:"h-4 w-4"})}),Ye(t)]})}),e.jsx("td",{className:D,children:e.jsx("button",{type:"button",role:"switch","aria-checked":l.enabled,"aria-label":l.enabled?s("users.detail.keyMenu.disableKey",{defaultValue:"Disable key"}):s("users.detail.keyMenu.enableKey",{defaultValue:"Enable key"}),title:l.enabled?s("users.detail.keyMenu.disableKey",{defaultValue:"Disable key"}):s("users.detail.keyMenu.enableKey",{defaultValue:"Enable key"}),disabled:me===l.inboundId,onClick:()=>{De(l)},className:`relative inline-flex h-6 w-11 items-center rounded-full border border-line/70 transition focus:outline-none focus:ring-2 focus:ring-brand-500/40 disabled:cursor-not-allowed disabled:opacity-50 ${l.enabled?"bg-emerald-500/25":"bg-panel/70"}`,children:e.jsx("span",{className:`inline-block h-5 w-5 transform rounded-full border border-line/70 bg-white shadow-sm transition ${l.enabled?"translate-x-5":"translate-x-1"}`})})}),e.jsxs("td",{className:D,children:[ke(t.online),e.jsx("p",{className:"mt-1 text-[11px] text-muted",children:d}),t.seenDevices>0?e.jsx("p",{className:"mt-0.5 text-[11px] text-muted",children:s("users.detail.keys.devicesCount",{defaultValue:"Devices {{online}}/{{seen}}",online:t.onlineDevices,seen:t.seenDevices})}):null]}),e.jsx("td",{className:D,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium text-foreground",children:r.email}),e.jsx("span",{className:"text-xs text-muted",children:t.label}),We(t)]})}),e.jsx("td",{className:D,children:e.jsx(Se,{variant:"info",children:t.protocol})}),e.jsx("td",{className:D,children:e.jsx("span",{className:"font-semibold text-foreground",children:t.port})}),e.jsx("td",{className:D,children:e.jsx("span",{className:"inline-flex items-center rounded-full border border-line/70 bg-card/70 px-3 py-1 text-xs font-semibold text-foreground",children:t.priority})}),e.jsx("td",{className:D,children:e.jsxs("div",{className:"w-48",children:[e.jsxs("p",{className:"text-xs text-muted",children:[w(J)," / ",V>0?w(V):"∞"]}),e.jsx("div",{className:"mt-1 h-2 rounded-full bg-panel/80",children:e.jsx("div",{className:"h-2 rounded-full bg-gradient-to-r from-brand-500 to-brand-600",style:{width:`${He}%`}})})]})}),e.jsx("td",{className:D,children:e.jsx("span",{className:`inline-flex rounded-full px-2 py-0.5 text-xs ${t.expirationDays<=0?"bg-red-500/20 text-red-300":t.expirationDays<=7?"bg-amber-500/20 text-amber-300":"bg-brand-500/20 text-brand-200"}`,children:t.expirationDays<=0?s("common.expired",{defaultValue:"Expired"}):s("users.detail.keys.shortDays",{defaultValue:"{{count}}d",count:t.expirationDays})})})]},l.id)})})]})}),e.jsx("div",{className:"grid grid-cols-1 gap-3 p-4 lg:hidden",children:oe.map(t=>{const l=t.relation,a=Ce(s,t.online,t.lastSeenAt,F);return e.jsxs("div",{className:`rounded-xl border border-line/70 bg-card/70 ${Ss}`,children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:t.label}),e.jsxs("p",{className:"text-xs text-muted",children:[t.protocol," · ",s("users.detail.keys.portLabelShort",{defaultValue:"Port"})," ",t.port]}),We(t)]}),e.jsxs("div",{className:"flex flex-col items-end gap-2 text-right",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[ke(t.online),Ye(t,{mobile:!0})]}),e.jsx("p",{className:"text-[11px] text-muted",children:a}),t.seenDevices>0?e.jsx("p",{className:"text-[11px] text-muted",children:s("users.detail.keys.devicesCount",{defaultValue:"Devices {{online}}/{{seen}}",online:t.onlineDevices,seen:t.seenDevices})}):null]})]}),e.jsxs("div",{className:`mt-3 ${As}`,children:[e.jsxs("p",{className:"text-xs text-muted",children:[s("users.detail.keys.table.priority",{defaultValue:"Priority"}),":"," ",e.jsx("span",{className:"inline-flex items-center rounded-full border border-line/70 bg-card/70 px-2 py-0.5 text-[11px] font-semibold text-foreground",children:t.priority})]}),e.jsxs("p",{className:"text-xs text-muted",children:[s("users.detail.keys.usageLabel",{defaultValue:"Usage"}),":"," ",w(J)," / ",V>0?w(V):"∞"]}),e.jsx("div",{className:"h-2 rounded-full bg-panel/80",children:e.jsx("div",{className:"h-2 rounded-full bg-gradient-to-r from-brand-500 to-brand-600",style:{width:`${He}%`}})}),e.jsxs("p",{className:"text-xs text-muted",children:[s("users.detail.keys.table.expiration",{defaultValue:"Expiration"}),":"," ",t.expirationDays<=0?s("common.expired",{defaultValue:"Expired"}):s("common.daysLeft",{defaultValue:"{{count}} days left",count:t.expirationDays})]})]}),e.jsxs("div",{className:`${Ts} flex items-center justify-between rounded-xl border border-line/70 bg-panel/40 px-3 py-2`,children:[e.jsx("span",{className:"text-xs font-medium text-foreground",children:s("common.enabled",{defaultValue:"Enabled"})}),e.jsx("button",{type:"button",role:"switch","aria-checked":l.enabled,"aria-label":l.enabled?s("users.detail.keyMenu.disableKey",{defaultValue:"Disable key"}):s("users.detail.keyMenu.enableKey",{defaultValue:"Enable key"}),title:l.enabled?s("users.detail.keyMenu.disableKey",{defaultValue:"Disable key"}):s("users.detail.keyMenu.enableKey",{defaultValue:"Enable key"}),disabled:me===l.inboundId,onClick:()=>{De(l)},className:`relative inline-flex h-6 w-11 items-center rounded-full border border-line/70 transition focus:outline-none focus:ring-2 focus:ring-brand-500/40 disabled:cursor-not-allowed disabled:opacity-50 ${l.enabled?"bg-emerald-500/25":"bg-card/70"}`,children:e.jsx("span",{className:`inline-block h-5 w-5 transform rounded-full border border-line/70 bg-white shadow-sm transition ${l.enabled?"translate-x-5":"translate-x-1"}`})})]})]},`mobile-${l.id}`)})})]})]}),e.jsxs(v,{children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-foreground",children:s("users.detail.devicesSessions.title",{defaultValue:"Device sessions"})}),e.jsx("p",{className:"text-xs text-muted",children:s("users.detail.devicesSessions.subtitle",{defaultValue:"{{online}} online / {{total}} seen in last {{minutes}} minutes",online:((ns=(rs=k.data)==null?void 0:rs.data)==null?void 0:ns.online)||0,total:((ds=(is=k.data)==null?void 0:is.data)==null?void 0:ds.total)||0,minutes:60})})]}),e.jsx(j,{variant:"ghost",size:"sm",onClick:()=>{k.refetch()},loading:k.isFetching,children:e.jsx(ue,{className:"h-4 w-4"})})]}),k.isLoading?e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{className:"h-10 w-full"}),e.jsx(Q,{className:"h-10 w-full"})]}):de.length===0?e.jsx("p",{className:"text-sm text-muted",children:s("users.devices.noneRecent",{defaultValue:"No devices tracked in the last {{minutes}} minutes.",minutes:60})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"text-left text-xs uppercase tracking-wide text-muted",children:e.jsxs("tr",{className:"border-b border-line/70",children:[e.jsx("th",{className:"py-2 pr-3",children:s("common.status",{defaultValue:"Status"})}),e.jsx("th",{className:"py-2 pr-3",children:s("users.detail.devicesSessions.columns.fingerprint",{defaultValue:"Fingerprint"})}),e.jsx("th",{className:"py-2 pr-3",children:s("users.detail.devicesSessions.columns.ip",{defaultValue:"IP"})}),e.jsx("th",{className:"py-2 pr-3",children:s("users.detail.devicesSessions.columns.lastSeen",{defaultValue:"Last seen"})}),e.jsx("th",{className:"py-2 text-right",children:s("common.action",{defaultValue:"Action"})})]})}),e.jsx("tbody",{children:de.slice(0,12).map(t=>e.jsxs("tr",{className:"border-b border-line/50",children:[e.jsx("td",{className:"py-2 pr-3",children:e.jsxs("span",{className:`inline-flex items-center gap-1.5 rounded-full px-2 py-0.5 text-xs ${t.online?"bg-emerald-500/15 text-emerald-300":"bg-zinc-500/15 text-zinc-300"}`,children:[e.jsxs("span",{className:"relative inline-flex h-2.5 w-2.5",children:[t.online?e.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-emerald-400 opacity-70"}):null,e.jsx("span",{className:`relative inline-flex h-2.5 w-2.5 rounded-full ${t.online?"bg-emerald-400":"bg-zinc-400"}`})]}),t.online?s("common.online",{defaultValue:"Online"}):s("common.offline",{defaultValue:"Offline"})]})}),e.jsx("td",{className:"py-2 pr-3 font-mono text-xs text-muted",children:t.shortFingerprint}),e.jsx("td",{className:"py-2 pr-3 text-muted",children:t.clientIp||"-"}),e.jsx("td",{className:"py-2 pr-3 text-muted",children:_(t.lastSeenAt)}),e.jsx("td",{className:"py-2 text-right",children:e.jsx(j,{size:"sm",variant:"ghost",onClick:()=>{Xs(t.fingerprint)},loading:Ne.isPending,children:s("common.revoke",{defaultValue:"Revoke"})})})]},t.fingerprint))})]})})]}),e.jsx(H.Suspense,{fallback:e.jsx(Me,{}),children:e.jsx(Ut,{userId:r.id})}),e.jsx(H.Suspense,{fallback:e.jsx(Me,{}),children:e.jsx(Rt,{userId:r.id})}),e.jsx(H.Suspense,{fallback:e.jsx(Me,{}),children:e.jsx(Ft,{userId:r.id})}),Z?e.jsx(ut,{user:r,onClose:()=>G(!1),onSuccess:()=>{G(!1),T()}}):null,Ke?e.jsx(dt,{inbound:Ke,initialUserId:r.id,onClose:()=>Ue(null)}):null,e.jsx(it,{open:!!i,title:qs,description:Zs,confirmLabel:et,cancelLabel:s("common.cancel",{defaultValue:"Cancel"}),tone:st,loading:qe,onCancel:()=>{qe||P(null)},onConfirm:()=>{Ys()}}),e.jsx(ms,{open:!!p,title:s("users.myanmarPriorityPreviewTitle",{defaultValue:"Myanmar Priority Preview"}),description:s("users.myanmarPriorityPreviewBody",{defaultValue:"Review current and new fallback order before applying."}),summaryRows:[{label:s("users.preview.totalKeys",{defaultValue:"Total keys"}),value:(p==null?void 0:p.totalKeys)??0},{label:s("users.preview.matchedKeys",{defaultValue:"Matched keys"}),value:(p==null?void 0:p.matchedKeys)??0},{label:s("users.preview.keysToReorder",{defaultValue:"Keys to reorder"}),value:(p==null?void 0:p.changedKeys)??0}],currentTop3:(p==null?void 0:p.currentTop3)||[],newTop3:(p==null?void 0:p.newTop3)||[],confirmLabel:s("users.applyPriority",{defaultValue:"Apply Priority"}),loading:fe,disableConfirm:!p||p.changedKeys===0,onClose:()=>{fe||ge(null)},onConfirm:()=>{_s()}}),e.jsx(ms,{open:!!f,title:s("users.qualityAutoTunePreviewTitle",{defaultValue:"Quality Auto-tune Preview"}),description:s("users.qualityAutoTunePreviewBody",{defaultValue:"Reorder keys based on recent connect success, rejects, and reconnects."}),summaryRows:[{label:s("users.preview.totalKeys",{defaultValue:"Total keys"}),value:(f==null?void 0:f.totalKeys)??0},{label:s("users.preview.telemetryKeys",{defaultValue:"Telemetry keys"}),value:(f==null?void 0:f.scoredKeys)??0},{label:s("users.preview.keysToReorder",{defaultValue:"Keys to reorder"}),value:(f==null?void 0:f.changedKeys)??0}],currentTop3:((f==null?void 0:f.currentTop3)||[]).map(t=>({key:t.key,toPriority:t.fromPriority})),newTop3:((f==null?void 0:f.newTop3)||[]).map(t=>({key:t.key,toPriority:t.toPriority})),previewLines:(f==null?void 0:f.previewLines)||[],confirmLabel:s("users.applyAutoTune",{defaultValue:"Apply Auto-tune"}),loading:xe,disableConfirm:!f||f.changedKeys===0,onClose:()=>{xe||je(null)},onConfirm:()=>{Hs()}})]})},Na=Ot;export{Ot as UserDetail,Na as UserDetailPage};
